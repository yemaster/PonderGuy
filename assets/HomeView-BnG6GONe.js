import{d as D,t as W,c as oe,o as c,a as g,r as V,b as m,n as j,u as d,e as Y,f as o,w as de,g as e,h as y,i as ae,j as E,k as M,l as ue,m as pe,F as P,p as ve,q as ge,s as me,v as fe,x as he,y as ye,z as we}from"./index-Cg0EeqSd.js";import{S as _e,C as xe,P as be,V as ke,M as Ce,a as Te,b as Se,A as Me,D as $e,d as se,W as ze,f as N}from"./methods-CyI6_l-K.js";import{u as Pe,G as Fe,M as Le}from"./index-Ds1QSJAm.js";import{_ as Be}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./constants-BDoWXNhu.js";import"./axios-DmY7Om-x.js";const Ee="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%20[%3c!ENTITY%20nbsp%20'%20'%3e]%3e%3csvg%20data-noselect=''%20width='200'%20height='200'%20ref='svg_canvas'%20preserveAspectRatio='none'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20style='background:%20transparent;'%3e%3cdefs%3e%3c/defs%3e%3cg%20xmlns='http://www.w3.org/2000/svg'%20id='shape_MFTiJwY3ZC'%20class=''%20ref='shape_MFTiJwY3ZC'%20key='shape_MFTiJwY3ZC'%20transform='translate(20,%2020)%20scale(1,1)'%20style='cursor:move;display:inline;opacity:1;'%20filter=''%3e%3cg%20style='display:inline'%3e%3crect%20fill='rgba(0,0,0,0)'%20width='180'%20height='180'%20x='-10'%20y='-10'/%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20version='1.1'%20id='图层_1'%20x='0px'%20y='0px'%20width='160'%20height='152.45622471038627'%20viewBox='2.6600608825683594%207.145834922790527%20194.84063720703125%20185.6541748046875'%20style='enable-background:new%200%200%20200%20200;'%20xml:space='preserve'%20class='style-removed'%20preserveAspectRatio='none'%20data-parent='shape_MFTiJwY3ZC'%3e%3cg%3e%3cg%3e%3cpath%20d='M130.6,142.6c-5.6-15-15-38.7-22.9-51.2c-13-20.6-23.4-16.3-19.7,6.4c3.6,22,11.1,48,18.2,62.6%20c-0.2,0.2-0.4,0.3-0.6,0.4c-12.3-13.2-32-30-46.8-39.9c-19.8-13.2-26.6-6.6-15.1,14c8.6,15.5,24.8,32.2,32.3,39.6%20c-21.1,7.4-38.9,8.8-47.2,7.8c-15.2-1.8-22-8.1-24.9-18c-4-13.6-1.1-56.9,51.6-93.4c40.7-28.2,71.3-11.1,85,5.4%20C150.6,88.7,163,113.2,130.6,142.6z'%20fill='%23EF8201'/%3e%3cpath%20d='M173.5,86.3c-13.1-0.2-23.8-7.1-23.6-11.5c0.2-4.4,10.8-10.9,24-10.7c13.1,0.2,23.7,3.8,23.6,11.5%20C197.4,82.8,186.7,86.6,173.5,86.3z'%20fill='%23BFD700'/%3e%3cpath%20d='M171.6,29.6c-6.4,13.4-26.4,39.9-31.7,37.4c-5.3-2.5,3-33.6,9.6-47c6.3-12.8,11.7-14.2,17.2-12%20C172.1,10.2,178,16.2,171.6,29.6z'%20fill='%2317A831'/%3e%3c/g%3e%3cg%3e%3cg%3e%3ccircle%20cx='112.9'%20cy='187.6'%20r='5.2'%20fill='%23EF8201'/%3e%3ccircle%20cx='131'%20cy='176.4'%20r='5.2'%20fill='%23EF8201'/%3e%3c/g%3e%3c/g%3e%3c/g%3e%3c/svg%3e%3c/g%3e%3c/g%3e%3c/svg%3e",Ae="/PonderGuy/logo.png",U=D({__name:"pgButton",props:{color:{type:String,default:"#1780db"},mode:{type:String,default:"round"},size:{type:String,default:"medium"}},setup(u){const w=u,{color:t,size:f,mode:h}=W(w),i=oe(()=>{const _=parseInt(t.value.substring(1,3),16),x=parseInt(t.value.substring(3,5),16),p=parseInt(t.value.substring(5,7),16);return _*.299+x*.587+p*.114>=192?"#212223":"#fcfbfe"});return(_,x)=>(c(),g("button",{class:j(["pg-button",`${d(f)} ${d(h)}`]),style:Y({backgroundColor:d(t),color:i.value})},[V(_.$slots,"default",{},()=>[m("wee")])],6))}}),Ge={class:"pg-modal-text"},Ie={key:0,class:"pg-modal-title"},Ve={class:"pg-modal-content"},De={class:"pg-modal-append"},Re=D({__name:"pgModal",props:{title:String,show:Boolean,backgroundColor:{type:String,default:"#ffffff"},mode:{type:String,default:"round"},backClick:{type:Boolean,default:!0},showAppend:{type:Boolean,default:!0}},emits:["update:show"],setup(u,{emit:w}){const t=u,f=w,{title:h,show:i,backClick:_,mode:x,showAppend:p}=W(t),F=o(i.value);function L(v=!1){(_.value||v)&&f("update:show",!i.value)}return de(()=>i.value,v=>{setTimeout(()=>{F.value=v},200)}),(v,b)=>(c(),g("div",{class:j(["pg-modal",{show:F.value,hide:!F.value,"show-append":d(p)}])},[e("div",{class:"pg-modal-back",onClick:b[0]||(b[0]=G=>L())}),e("div",{class:j(["pg-modal-container",{show:d(i),hide:!d(i),round:d(x)==="round"}]),style:Y(`background-color: ${u.backgroundColor}`)},[e("div",Ge,[d(h)?(c(),g("div",Ie,y(d(h)),1)):ae("",!0),e("div",Ve,[V(v.$slots,"content",{},()=>[m("Modal Info")])])]),e("div",De,[V(v.$slots,"append",{},()=>[E(U,{size:"small",onClick:b[1]||(b[1]=G=>L(!0))},{default:M(()=>[m("关闭")]),_:1})])])],6)],2))}}),He={class:"pg-progress-container"},Ne={class:"pg-progress"},je={class:"pg-progress-text"},Ue=D({__name:"pgProgress",props:{progress:{type:Number,default:0}},setup(u){const w=u,{progress:t}=W(w),f=oe(()=>t.value<0?0:t.value>100?100:t.value.toFixed(2));return(h,i)=>(c(),g("div",He,[e("div",Ne,[e("div",{class:"pg-progress-bar",style:Y(`width: ${f.value}%`)},null,4)]),e("div",je,[V(h.$slots,"default",{},()=>[m(y(f.value)+"%",1)])])]))}}),A=u=>(he("data-v-84a73df0"),u=u(),ye(),u),We=A(()=>e("img",{src:Ee},null,-1)),Ye=A(()=>e("span",null,"VegeTable Game",-1)),qe=[We,Ye],Je=A(()=>e("div",{class:"progress-page"},null,-1)),Ze={key:0,class:"spinner-border loader"},Oe=A(()=>e("canvas",{id:"home-scene"},null,-1)),Ke={style:{display:"flex"}},Qe=A(()=>e("div",{style:{"margin-right":"10px"}},[e("img",{src:Ae,width:"64px",style:{"border-radius":"15px"}})],-1)),Xe={style:{"font-size":"20px","font-weight":"bold",margin:"10px 0 5px 0"}},et={style:{"font-size":"14px"}},tt={class:"update-log"},st=["innerHTML"],ot={style:{width:"100%","margin-bottom":"5px","font-size":"14px"}},at=D({__name:"HomeView",setup(u){const w=Pe(),t=we(),f=o(),h=o(),i=o(),_=o(),x=o(),p=o(),F=ve();document.title="Ponder Guy";let L=0;const v=o(!1),b=o(!1),G=o("unknown"),q=o("unknown"),ne=o("暂无更新日志"),J=o(0),Z=o(0),O=o(0),I=o(0),C=(a=500)=>{setTimeout(()=>{x.value.style.opacity="0",x.value.style.visibility="hidden",_.value.style.opacity="1",_.value.style.visibility="visible",v.value=!1},a)},le=()=>{var s,l;b.value=!0,I.value=0;const a=(l=(s=t==null?void 0:t.appContext.config.globalProperties)==null?void 0:s.$injectFunc)==null?void 0:l.update;a?a((n,$,z,te)=>{I.value=n,J.value=$,O.value=z,Z.value=te},()=>{r.value="更新成功!",setTimeout(()=>{r.value="正在重启程序..."},1e3),setTimeout(()=>{var $,z;const n=(z=($=t==null?void 0:t.appContext.config.globalProperties)==null?void 0:$.$injectFunc)==null?void 0:z.restartAPP;n?n():(r.value="重启失败，请手动重启！",setTimeout(()=>{C()},1e3))},2e3)},()=>{r.value="更新失败!",C()}):(r.value="更新失败!",C())};function K(){L++,L>1&&(i.value.classList.remove("first"),h.value.style.opacity="0",p.value.style.opacity="0",p.value.style.visibility="hidden",x.value.style.opacity="1",setTimeout(()=>{h.value.style.visibility="hidden"},500),setTimeout(()=>{i.value.style.zIndex="0"},800),setTimeout(()=>{var s,l;r.value="检查更新中...";const a=(l=(s=t==null?void 0:t.appContext.config.globalProperties)==null?void 0:s.$injectFunc)==null?void 0:l.checkUpdate;a?a((n,$,z,te)=>{q.value=$,G.value=z,n?(v.value=!0,r.value=""):C()},n=>{r.value="更新检查失败",console.log(n),C()}):(r.value="更新检查失败",console.log("NO",window==null?void 0:window.injectFunctions),C())},1e3))}const r=o(""),k={width:window.innerWidth,height:window.innerHeight};let R;const T=new _e;T.background=new xe(16711613);const B=new be(75,k.width/k.height,.1,50);B.position.set(-5,5,20),B.lookAt(new ke(15,15,0));const Q=new Ce(new Te(100,100),new Se({color:15658734}));Q.rotation.x=-Math.PI/2,T.add(Q);const ie=new Me(16777215,2);T.add(ie);const X=new $e(16777215,.9);X.position.set(0,40,0),T.add(X);let S;function ee(){S.render(T,B),w.updateAnimation(),requestAnimationFrame(ee)}const H=()=>{const a=R.getBoundingClientRect();k.height=a.height,k.width=a.width,B.aspect=k.width/k.height,B.updateProjectionMatrix(),S.setSize(k.width,k.height),S.setPixelRatio(window.devicePixelRatio)},re=()=>{R=document.querySelector("#home-scene"),S=new ze({antialias:!0,canvas:R}),new Fe().setMeshoptDecoder(Le),w.getPonderModel().then(s=>{const n=ge(s).scene;n.scale.set(15,15,15),T.add(n),w.setAnimation("Sitting"),K()}),H(),requestAnimationFrame(ee)};window.addEventListener("resize",se(H,100)),ue(()=>{p.value.style.visibility="visible",p.value.style.opacity="1",re(),setTimeout(()=>{f.value.style.opacity="1"},100),setTimeout(()=>{f.value.style.opacity="0"},2e3),setTimeout(()=>{i.value.style.opacity="1"},3e3),setTimeout(()=>{K()},4e3)});function ce(){p.value.style.visibility="visible",p.value.style.opacity="1",setTimeout(()=>{F.push("/game/list")},500)}return pe(()=>{var a;window.removeEventListener("resize",se(H,100));try{S.dispose(),S.forceContextLoss();let s=S.domElement.getContext("webgl");s&&s.getExtension("WEBGL_lose_context")&&((a=s.getExtension("WEBGL_lose_context"))==null||a.loseContext()),T.traverse(l=>{l.material&&l.material.dispose(),l.geometry&&l.geometry.dispose(),l=null})}catch(s){console.error("Failed to destroy threejs",s)}}),(a,s)=>{const l=me("tempalte");return c(),g(P,null,[e("div",{class:"cover",ref_key:"cover",ref:p},null,512),e("div",{class:"fog",ref_key:"fog",ref:h},[e("div",{class:"com-logo",ref_key:"cl",ref:f},qe,512)],512),Je,e("div",null,[e("div",{class:"pg-header-logo first",ref_key:"pageHeader",ref:i},"Ponder Guy",512),e("div",{class:"pg-start-button",ref_key:"startButton",ref:_,onClick:ce},"点 击 开 始",512),e("div",{class:"pg-start-text",ref_key:"startText",ref:x},[r.value.length>0?(c(),g("div",Ze)):ae("",!0),m(" "+y(r.value),1)],512)]),Oe,E(Re,{title:"",backClick:!1,backgroundColor:"#f0f1f3",mode:"round",show:v.value,"onUpdate:show":s[2]||(s[2]=n=>v.value=n)},{content:M(()=>[e("div",Ke,[Qe,e("div",null,[e("div",Xe,[b.value?(c(),g(P,{key:0},[m("更新中")],64)):(c(),fe(l,{key:1},{default:M(()=>[m("有新版本啦！")]),_:1}))]),e("div",et,"当前版本："+y(q.value)+" → 升级到："+y(G.value),1)])]),e("div",tt,[e("div",{innerHTML:ne.value},null,8,st)])]),append:M(()=>[b.value?(c(),g(P,{key:0},[e("div",ot,y(d(N)(Z.value))+" / "+y(d(N)(O.value))+"   "+y(d(N)(J.value))+"/s. ",1),E(Ue,{progress:I.value},{default:M(()=>[r.value.length>0?(c(),g(P,{key:0},[m(y(r.value),1)],64)):(c(),g(P,{key:1},[m(y(I.value.toFixed(2))+"% ",1)],64))]),_:1},8,["progress"])],64)):(c(),g(P,{key:1},[E(U,{color:"#db2828",style:{width:"100px"},mode:"round",size:"tiny",onClick:s[0]||(s[0]=n=>C(0))},{default:M(()=>[m("取消(")]),_:1}),E(U,{color:"#47af50",style:{width:"100px"},mode:"round",size:"tiny",onClick:s[1]||(s[1]=n=>le())},{default:M(()=>[m("更新!")]),_:1})],64))]),_:1},8,["show"])],64)}}}),ut=Be(at,[["__scopeId","data-v-84a73df0"]]);export{ut as default};
