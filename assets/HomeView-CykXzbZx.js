import{d as Q,t as ae,c as ne,o as r,a as u,b as e,n as ie,r as le,e as p,f as c,g as s,h as re,i as ce,j as de,k as z,w as x,F as b,u as ue,l as pe,m as ve,p as ge,q as A,s as me,v as he,x as fe}from"./index-DpkYZs8z.js";import{S as ye,C as we,P as _e,V as xe,M as be,a as ke,b as Ce,A as Te,D as Se,d as O,W as Me,f as D}from"./methods-q6XqSTUg.js";import{u as Pe,G as Fe,M as Le}from"./index-nTi6nIMd.js";import{_ as ze,a as K}from"./pgModal.vue_vue_type_style_index_0_lang-DF6SBPhe.js";import{_ as Ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./constants-BDoWXNhu.js";import"./axios-DmY7Om-x.js";const Be="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%20[%3c!ENTITY%20nbsp%20'%20'%3e]%3e%3csvg%20data-noselect=''%20width='200'%20height='200'%20ref='svg_canvas'%20preserveAspectRatio='none'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20style='background:%20transparent;'%3e%3cdefs%3e%3c/defs%3e%3cg%20xmlns='http://www.w3.org/2000/svg'%20id='shape_MFTiJwY3ZC'%20class=''%20ref='shape_MFTiJwY3ZC'%20key='shape_MFTiJwY3ZC'%20transform='translate(20,%2020)%20scale(1,1)'%20style='cursor:move;display:inline;opacity:1;'%20filter=''%3e%3cg%20style='display:inline'%3e%3crect%20fill='rgba(0,0,0,0)'%20width='180'%20height='180'%20x='-10'%20y='-10'/%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20version='1.1'%20id='图层_1'%20x='0px'%20y='0px'%20width='160'%20height='152.45622471038627'%20viewBox='2.6600608825683594%207.145834922790527%20194.84063720703125%20185.6541748046875'%20style='enable-background:new%200%200%20200%20200;'%20xml:space='preserve'%20class='style-removed'%20preserveAspectRatio='none'%20data-parent='shape_MFTiJwY3ZC'%3e%3cg%3e%3cg%3e%3cpath%20d='M130.6,142.6c-5.6-15-15-38.7-22.9-51.2c-13-20.6-23.4-16.3-19.7,6.4c3.6,22,11.1,48,18.2,62.6%20c-0.2,0.2-0.4,0.3-0.6,0.4c-12.3-13.2-32-30-46.8-39.9c-19.8-13.2-26.6-6.6-15.1,14c8.6,15.5,24.8,32.2,32.3,39.6%20c-21.1,7.4-38.9,8.8-47.2,7.8c-15.2-1.8-22-8.1-24.9-18c-4-13.6-1.1-56.9,51.6-93.4c40.7-28.2,71.3-11.1,85,5.4%20C150.6,88.7,163,113.2,130.6,142.6z'%20fill='%23EF8201'/%3e%3cpath%20d='M173.5,86.3c-13.1-0.2-23.8-7.1-23.6-11.5c0.2-4.4,10.8-10.9,24-10.7c13.1,0.2,23.7,3.8,23.6,11.5%20C197.4,82.8,186.7,86.6,173.5,86.3z'%20fill='%23BFD700'/%3e%3cpath%20d='M171.6,29.6c-6.4,13.4-26.4,39.9-31.7,37.4c-5.3-2.5,3-33.6,9.6-47c6.3-12.8,11.7-14.2,17.2-12%20C172.1,10.2,178,16.2,171.6,29.6z'%20fill='%2317A831'/%3e%3c/g%3e%3cg%3e%3cg%3e%3ccircle%20cx='112.9'%20cy='187.6'%20r='5.2'%20fill='%23EF8201'/%3e%3ccircle%20cx='131'%20cy='176.4'%20r='5.2'%20fill='%23EF8201'/%3e%3c/g%3e%3c/g%3e%3c/g%3e%3c/svg%3e%3c/g%3e%3c/g%3e%3c/svg%3e",Ge="/PonderGuy/logo.png",$e={class:"pg-progress-container"},Ve={class:"pg-progress"},Ae={class:"pg-progress-text"},De=Q({__name:"pgProgress",props:{progress:{type:Number,default:0}},setup(f){const k=f,{progress:i}=ae(k),y=ne(()=>i.value<0?0:i.value>100?100:i.value.toFixed(2));return(C,T)=>(r(),u("div",$e,[e("div",Ve,[e("div",{class:"pg-progress-bar",style:ie(`width: ${y.value}%`)},null,4)]),e("div",Ae,[le(C.$slots,"default",{},()=>[p(c(y.value)+"%",1)])])]))}}),M=f=>(me("data-v-10b4c537"),f=f(),he(),f),Re=M(()=>e("img",{src:Be},null,-1)),Ie=M(()=>e("span",null,"VegeTable Game",-1)),He=[Re,Ie],Ne=M(()=>e("div",{class:"progress-page"},null,-1)),je={key:0,class:"spinner-border loader"},Ue=M(()=>e("canvas",{id:"home-scene"},null,-1)),We={style:{display:"flex"}},Ye=M(()=>e("div",{style:{"margin-right":"10px"}},[e("img",{src:Ge,width:"64px",style:{"border-radius":"15px"}})],-1)),qe={style:{"font-size":"20px","font-weight":"bold",margin:"10px 0 5px 0"}},Je={style:{"font-size":"14px"}},Ze={class:"update-log"},Oe=["innerHTML"],Ke={style:{width:"100%","margin-bottom":"5px","font-size":"14px"}},Qe=Q({__name:"HomeView",setup(f){const k=Pe(),i=fe(),y=s(),C=s(),T=s(),E=s(),P=s(),v=s(),X=ue();document.title="Ponder Guy";let R=0;const F=s(!1),B=s(!1),I=s("unknown"),H=s("unknown"),N=s("暂无更新日志"),j=s(0),U=s(0),W=s(0),L=s(0),g=(o=500)=>{setTimeout(()=>{P.value.style.opacity="0",P.value.style.visibility="hidden",E.value.style.opacity="1",E.value.style.visibility="visible",F.value=!1},o)},ee=()=>{var t,n;B.value=!0,L.value=0;const o=(n=(t=i==null?void 0:i.appContext.config.globalProperties)==null?void 0:t.$injectFunc)==null?void 0:n.update;o?o((a,w,_,V)=>{L.value=a,j.value=w,W.value=_,U.value=V},()=>{l.value="更新成功!",setTimeout(()=>{l.value="正在重启程序..."},1e3),setTimeout(()=>{var w,_;const a=(_=(w=i==null?void 0:i.appContext.config.globalProperties)==null?void 0:w.$injectFunc)==null?void 0:_.restartAPP;a?a():(l.value="重启失败，请手动重启！",setTimeout(()=>{g()},1e3))},2e3)},()=>{l.value="更新失败!",g()}):(l.value="更新失败!",g())};function Y(){R++,R>1&&(T.value.classList.remove("first"),C.value.style.opacity="0",v.value.style.opacity="0",v.value.style.visibility="hidden",P.value.style.opacity="1",setTimeout(()=>{C.value.style.visibility="hidden"},500),setTimeout(()=>{T.value.style.zIndex="0"},800),setTimeout(()=>{var t,n;l.value="检查更新中...";const o=(n=(t=i==null?void 0:i.appContext.config.globalProperties)==null?void 0:t.$injectFunc)==null?void 0:n.checkUpdate;o?o((a,w,_,V)=>{H.value=w,I.value=_,N.value=V,a?(F.value=!0,l.value=""):g()},a=>{l.value="更新检查失败",console.log(a),g()}):(l.value="更新检查失败",console.log("NO",window==null?void 0:window.injectFunctions),g())},1e3))}const l=s(""),d={width:window.innerWidth,height:window.innerHeight};let G;const m=new ye;m.background=new we(16711613);const S=new _e(75,d.width/d.height,.1,50);S.position.set(-5,5,20),S.lookAt(new xe(15,15,0));const q=new be(new ke(100,100),new Ce({color:15658734}));q.rotation.x=-Math.PI/2,m.add(q);const te=new Te(16777215,2);m.add(te);const J=new Se(16777215,.9);J.position.set(0,40,0),m.add(J);let h;function Z(){h.render(m,S),k.updateAnimation(),requestAnimationFrame(Z)}const $=()=>{const o=G.getBoundingClientRect();d.height=o.height,d.width=o.width,S.aspect=d.width/d.height,S.updateProjectionMatrix(),h.setSize(d.width,d.height),h.setPixelRatio(window.devicePixelRatio)},se=()=>{G=document.querySelector("#home-scene"),h=new Me({antialias:!0,canvas:G}),new Fe().setMeshoptDecoder(Le),k.getPonderModel().then(t=>{const a=pe(t).scene;a.scale.set(15,15,15),m.add(a),k.setAnimation("Sitting"),Y()}),$(),requestAnimationFrame(Z)};window.addEventListener("resize",O($,100)),re(()=>{v.value.style.visibility="visible",v.value.style.opacity="1",se(),setTimeout(()=>{y.value.style.opacity="1"},100),setTimeout(()=>{y.value.style.opacity="0"},2e3),setTimeout(()=>{T.value.style.opacity="1"},3e3),setTimeout(()=>{Y()},4e3)});function oe(){v.value.style.visibility="visible",v.value.style.opacity="1",setTimeout(()=>{X.push("/game/list")},500)}return ce(()=>{var o;window.removeEventListener("resize",O($,100));try{h.dispose(),h.forceContextLoss();let t=h.domElement.getContext("webgl");t&&t.getExtension("WEBGL_lose_context")&&((o=t.getExtension("WEBGL_lose_context"))==null||o.loseContext()),m.traverse(n=>{n.material&&n.material.dispose(),n.geometry&&n.geometry.dispose(),n=null})}catch(t){console.error("Failed to destroy threejs",t)}}),(o,t)=>{const n=ve("tempalte");return r(),u(b,null,[e("div",{class:"cover",ref_key:"cover",ref:v},null,512),e("div",{class:"fog",ref_key:"fog",ref:C},[e("div",{class:"com-logo",ref_key:"cl",ref:y},He,512)],512),Ne,e("div",null,[e("div",{class:"pg-header-logo first",ref_key:"pageHeader",ref:T},"Ponder Guy",512),e("div",{class:"pg-start-button",ref_key:"startButton",ref:E,onClick:oe},"点 击 开 始",512),e("div",{class:"pg-start-text",ref_key:"startText",ref:P},[l.value.length>0?(r(),u("div",je)):de("",!0),p(" "+c(l.value),1)],512)]),Ue,z(ze,{title:"",backClick:!1,backgroundColor:"#f0f1f3",mode:"round",show:F.value,"onUpdate:show":t[2]||(t[2]=a=>F.value=a)},{content:x(()=>[e("div",We,[Ye,e("div",null,[e("div",qe,[B.value?(r(),u(b,{key:0},[p("更新中")],64)):(r(),ge(n,{key:1},{default:x(()=>[p("有新版本啦！")]),_:1}))]),e("div",Je,"当前版本："+c(H.value)+" → 升级到："+c(I.value),1)])]),e("div",Ze,[e("div",{innerHTML:N.value},null,8,Oe)])]),append:x(()=>[B.value?(r(),u(b,{key:0},[e("div",Ke,c(A(D)(U.value))+" / "+c(A(D)(W.value))+"   "+c(A(D)(j.value))+"/s. ",1),z(De,{progress:L.value},{default:x(()=>[l.value.length>0?(r(),u(b,{key:0},[p(c(l.value),1)],64)):(r(),u(b,{key:1},[p(c(L.value.toFixed(2))+"% ",1)],64))]),_:1},8,["progress"])],64)):(r(),u(b,{key:1},[z(K,{color:"#db2828",style:{width:"100px"},mode:"round",size:"tiny",onClick:t[0]||(t[0]=a=>g(0))},{default:x(()=>[p("取消(")]),_:1}),z(K,{color:"#47af50",style:{width:"100px"},mode:"round",size:"tiny",onClick:t[1]||(t[1]=a=>ee())},{default:x(()=>[p("更新!")]),_:1})],64))]),_:1},8,["show"])],64)}}}),it=Ee(Qe,[["__scopeId","data-v-10b4c537"]]);export{it as default};
